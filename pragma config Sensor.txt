#pragma config(Sensor, S1,     sensorCara,     sensorEV3_Color)

#pragma config(Sensor, S2,     sensorBarva,    sensorColorNxtFULL)

#pragma config(Sensor, S4,     sensorDelka,    sensorEV3_Ultrasonic)

#pragma config(Motor,  motorA,          motorL,        tmotorEV3_Large, PIDControl, encoder)

#pragma config(Motor,  motorD,          motorR,        tmotorEV3_Large, PIDControl, encoder)

//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

 

int minLight=100;

int barva=0;

int pcervena;

int pmodra;

int pzelena;

int pzluta;

 

void jizda(int vLeft, int vRight, int t)

{

                motor[motorA]=vLeft;

                motor[motorD]=vRight;

                if(t>0)

                               wait1Msec(t);

}

 

task Mereni(){

      while(true){

            if(minLight>SensorValue[S1])

                  minLight=SensorValue[S1];

      }

}

 

void CaraPid(){

      int idealniHodnota=20;

      int v=20;

      float index=0.4;

      int namerenaHodnota=SensorValue[S1];

      int rozdilHodnot=namerenaHodnota-idealniHodnota;

 

      motor[motorR]=v+index*rozdilHodnot;

      motor[motorL]=v-index*rozdilHodnot;

}

 

 

 

task main()

{

 

startTask(Mereni);

                displayBigTextLine(2,"pocet: %d",pcervena);

                displayBigTextLine(3,"pocet: %d",pzluta);

                displayBigTextLine(4,"pocet: %d",pmodra);

                displayBigTextLine(5,"pocet: %d",pzelena);

      // 4 zluta

      // 5 cervena

      // 2 modra

      // 3 zelena

while(true){

                if(SensorValue[S2]==4){pzluta++;

                               jizda(20,20,500);}

                               if(SensorValue[S2]==5){pcervena++;

                               jizda(20,20,500);}

                               if(SensorValue[S2]==2){pmodra++;

                               jizda(20,20,500);}

                               if(SensorValue[S2]==3){pzelena++;

                               jizda(20,20,500);}

                else {CaraPid();}

 

}

}
